







<pre><code>
Step1: Requirement 核心需求 + Capacity estimation

    Requirements: Upload/View/Search/metadata/comment

    DAU: 一般为500M 这个数量级别
    QPS:  DAU * average operation/86400 = QPS

        注意这个service是读请求多还是写请求多, 这会影响数据库的选用. 读请求多可以用cache优化

    Storage: 计算每天,每个月要用多少硬盘
    Bandwidth: 这个一般不是很好估计，incoming traffic vs outgoing traffic



Step 2: System API





Step 3: Service


     Client                 Web server(API server) -> App Server -> distributed File system(Amazon S3, GFS(big table)) store large file: log, video, image
                                                                            
                                                          |

                                                    Cache(Either in AppServer  or seperate cache server)


                                                          |
                                                          
     CDN                                            Metadata Database



Step4: DB(Schema, partitioning)

      Go through a complete workflow




Step5: How to Scale
    Traffic control: DNS load balance, load balancer(HLB, SLB)
    
    Master/slave, enventual consistency.
    
    Cache: 80-20 Rule, 
           20 percent of daily read volume generates 80%
           of traffic, we only need to cache 20% of daily read volume of videos and metadata.
    
    
    Sharding:
    1. by user. Drawback: popular user(high Qps, high storage)
    2. consistent hashing. aggregator, global unique id. 
    
    replication, single point failure. 

    CDN


    Go through non valina path.


</code>
</pre>
